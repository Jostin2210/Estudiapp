<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EstudiApp - Tu an치lisis de estudio</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Tempus Dominus CSS -->
    <link href="https://cdn.jsdelivr.net/npm/@eonasdan/tempus-dominus@6.9.4/dist/css/tempus-dominus.min.css" rel="stylesheet">
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Bootstrap 5 JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
    <!-- Tempus Dominus JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/@eonasdan/tempus-dominus@6.9.4/dist/js/tempus-dominus.min.js"></script>
    <!-- Tempus Dominus Locales -->
    <script src="https://cdn.jsdelivr.net/npm/@eonasdan/tempus-dominus@6.9.4/dist/locales/es.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- jsPDF y autoTable para exportar PDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.7.0/jspdf.plugin.autotable.min.js"></script>
    <!-- Firebase App (core) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <!-- Realtime Database -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
</head>
<body>
    <header>
        <div class="logo">
            <img src="https://cdn-icons-png.flaticon.com/512/2232/2232688.png" alt="EstudiApp Logo" style="height: 40px;">
            <h1>EstudiApp</h1>
        </div>
        <nav>
            <button class="nav-btn" data-page="home">Inicio</button>
            <button class="nav-btn" data-page="registro">Estudiar</button>
            <button class="nav-btn" data-page="estadisticas">Estad칤sticas</button>
            <button class="nav-btn" data-page="historial">Historial</button>
            <button class="nav-btn" data-page="perfil">Perfil</button>
            <button id="logout-btn" class="nav-btn">Cerrar Sesi칩n</button>
        </nav>
    </header>

    <main>
        <!-- Pantalla de Bienvenida / Home -->
        <section id="home" class="page active">
            <div class="welcome-container">
                <div class="welcome-content">
                    <img src="https://img.freepik.com/free-vector/students-studying-together-illustration_23-2148570890.jpg" alt="Ilustraci칩n de estudio" class="welcome-img">
                    <h2>춰Listo para conquistar tus metas de estudio hoy? 游눩游닄</h2>
                    <p>Registra tus sesiones de estudio y visualiza tu progreso de forma sencilla</p>
                    <div class="welcome-buttons">
                        <button class="btn primary-btn" id="start-study-btn">Empezar a estudiar</button>
                        <button class="btn secondary-btn" id="view-stats-btn">Ver estad칤sticas</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Pantalla de Registro de Estudio -->
        <section id="registro" class="page">
            <div class="container">
                <h2>Registra tu sesi칩n de estudio</h2>
                <form id="estudio-form">
                    <div class="form-group">
                        <label for="materia">Materia:</label>
                        <select id="materia" class="form-select" required>
                            <option value="">Selecciona una materia</option>
                            <option value="Matem치ticas">Matem치ticas</option>
                            <option value="Historia">Historia</option>
                            <option value="Ciencias">Ciencias</option>
                            <option value="Literatura">Literatura</option>
                            <option value="Idiomas">Idiomas</option>
                            <option value="Programaci칩n">Programaci칩n</option>
                            <option value="Otra">Otra</option>
                        </select>
                    </div>
                    <div class="form-group" id="otra-materia-group" style="display: none;">
                        <label for="otra-materia">Nombre de la materia:</label>
                        <input type="text" id="otra-materia" class="form-control" placeholder="Escribe el nombre de la materia">
                    </div>
                    <div class="form-group">
                        <label for="fecha">Fecha:</label>
                        <div class="input-group">
                            <input type="date" id="fecha" class="form-control" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="hora-inicio">Hora de inicio:</label>
                            <div class="input-group">
                                <input type="time" id="hora-inicio" class="form-control" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="hora-fin">Hora de fin:</label>
                            <div class="input-group">
                                <input type="time" id="hora-fin" class="form-control" required>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="notas">Comentario (opcional):</label>
                        <textarea id="notas" class="form-control" placeholder="Ej: Me cost칩 concentrarme, Hoy avanc칠 mucho..."></textarea>
                    </div>
                    <button type="submit" class="btn primary-btn">Guardar sesi칩n</button>
                </form>
            </div>
        </section>

        <!-- Pantalla de Estad칤sticas -->
        <section id="estadisticas" class="page">
            <div class="container">
                <h2>Tus Estad칤sticas de Estudio</h2>
                <div class="stats-summary">
                    <div class="stat-card">
                        <h3>Total de horas este mes </h3>
                        <p id="total-semana">0 horas este mes</p>
                    </div>
                    <div class="stat-card">
                        <h3>Promedio diario</h3>
                        <p id="promedio-diario">0 horas</p>
                    </div>
                    <div class="stat-card">
                        <h3>D칤a m치s productivo</h3>
                        <p id="dia-mas">Ninguno</p>
                    </div>
                    <div class="stat-card">
                        <h3>D칤a menos productivo</h3>
                        <p id="dia-menos">Ninguno</p>
                    </div>
                </div>
                <div class="goals-summary">
                    <h4>Meta de estudio mensual</h4>
                    <form id="goal-form" class="row g-2 align-items-center">
                        <div class="col-auto">
                            <input type="number" id="goal-hours" class="form-control" min="1" placeholder="Horas" required>
                        </div>
                        <div class="col-auto">
                            <button type="submit" class="btn btn-success">Guardar meta</button>
                        </div>
                        <div class="col-auto">
                            <div class="w-100" style="min-width:200px;max-width:300px;">
                                <div class="progress" style="height: 24px;">
                                    <div id="goal-progress-bar" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0 / 0 h (0%)</div>
                                </div>
                                <button id="btn-borrar-meta" class="btn btn-danger btn-sm mt-2" style="display:none;">Borrar meta</button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="row mb-3">
                    <div class="col-auto">
                        <label for="stats-date-start" class="form-label">Desde:</label>
                        <input type="date" id="stats-date-start" class="form-control">
                    </div>
                    <div class="col-auto">
                        <label for="stats-date-end" class="form-label">Hasta:</label>
                        <input type="date" id="stats-date-end" class="form-control">
                    </div>
                </div>
                <div class="charts-container">
                    <div class="chart-wrapper">
                        <h3>Horas estudiadas por d칤a</h3>
                        <canvas id="chart-dias"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <h3>Distribuci칩n de materias</h3>
                        <canvas id="chart-materias"></canvas>
                    </div>
                    <div class="chart-wrapper">
                        <h3>Distribuci칩n de duraci칩n de sesiones</h3>
                        <canvas id="chart-duracion-sesiones"></canvas>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col">
                        <h5>Duraci칩n promedio de sesi칩n: <span id="avg-duration">0</span> h</h5>
                        <h5>Duraci칩n mediana de sesi칩n: <span id="median-duration">0</span> h</h5>
                        <h5>Duraci칩n moda de sesi칩n: <span id="mode-duration">0</span> h</h5>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col">
                        <div class="card" id="informe-automatico" style="background:#f8f9fa; border-left: 5px solid #a67c52;">
                            <div class="card-body">
                                <h5 class="card-title"><i class="fa fa-chart-bar"></i> Resumen de tu mes</h5>
                                <ul id="lista-informe" class="mb-0"></ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Pantalla de Historial -->
        <section id="historial" class="page">
            <div class="container">
                <div class="table-container">
                    <div class="table-header">
                        <h3>Historial de Sesiones</h3>
                        <div class="table-controls">
                            <select id="filtroFecha" class="form-control">
                                <option value="todas">Todas las fechas</option>
                                <option value="semana">Esta semana</option>
                                <option value="mes">Este mes</option>
                            </select>
                            <select id="filtroMateria" class="form-control">
                                <option value="todas">Todas las materias</option>
                            </select>
                        </div>
                    </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th><input type="checkbox" id="selectAll"> Seleccionar</th>
                                <th>Fecha</th>
                                <th>Materia</th>
                                <th>Duraci칩n</th>
                                <th>Notas</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="historial-body">
                            <!-- El contenido se llenar치 din치micamente -->
                        </tbody>
                    </table>
                    <button id="deleteSelected" class="btn btn-danger" style="display: none;">
                        Eliminar seleccionados
                    </button>
                </div>
            </div>
        </section>

        <!-- Pantalla de Perfil -->
        <section id="perfil" class="page">
            <div class="container">
                <div class="profile-container">
                    <div class="profile-header">
                        <div class="profile-avatar">
                            <i class="fas fa-user-circle fa-5x"></i>
                        </div>
                        <div class="profile-info">
                            <h2 id="profile-name">Nombre de Usuario</h2>
                            <p id="profile-email">usuario@ejemplo.com</p>
                            <p id="profile-joined">Miembro desde: 01/01/2023</p>
                        </div>
                    </div>
                    <div class="profile-stats">
                        <div class="stat-card">
                            <h3>Total de sesiones</h3>
                            <p id="profile-sessions">0</p>
                        </div>
                        <div class="stat-card">
                            <h3>Horas totales</h3>
                            <p id="profile-hours">0</p>
                        </div>
                        <div class="stat-card">
                            <h3>Materia favorita</h3>
                            <p id="profile-subject">Ninguna</p>
                        </div>
                    </div>
                    <div class="profile-actions">
                        <button id="edit-profile-btn" class="btn secondary-btn">
                            <i class="fas fa-edit"></i> Editar perfil
                        </button>
                        <button id="change-password-btn" class="btn secondary-btn">
                            <i class="fas fa-key"></i> Cambiar contrase침a
                        </button>
                        <button id="btn-export-pdf" class="btn btn-outline-primary">
                            <i class="fas fa-file-pdf"></i> Exportar PDF de estad칤sticas
                        </button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>EstudiApp 춸 2025 - Desarrollado con 游눘 para ayudarte a estudiar mejor</p>
    </footer>

    <!-- Modal Editar Perfil -->
    <div class="modal fade" id="editProfileModal" tabindex="-1" aria-labelledby="editProfileModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="editProfileModalLabel">Editar Perfil</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="edit-profile-form">
                        <div class="text-center mb-4">
                            <div class="profile-image-container">
                                <img id="profile-preview" src="https://cdn-icons-png.flaticon.com/512/1077/1077114.png" alt="Foto de perfil" class="profile-image-preview">
                                <div class="profile-image-overlay">
                                    <label for="profile-image" class="profile-image-label">
                                        <i class="fas fa-camera"></i>
                                    </label>
                                    <input type="file" id="profile-image" accept="image/*" class="d-none">
                                </div>
                            </div>
                        </div>
                        <div class="form-group mb-3">
                            <label for="edit-nombre" class="form-label">Nombre:</label>
                            <input type="text" id="edit-nombre" class="form-control" required>
                        </div>
                        <div class="form-group mb-3">
                            <label for="edit-email" class="form-label">Email:</label>
                            <input type="email" id="edit-email" class="form-control" required>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="save-profile-btn">Guardar cambios</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Cambiar Contrase침a -->
    <div class="modal fade" id="changePasswordModal" tabindex="-1" aria-labelledby="changePasswordModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="changePasswordModalLabel">Cambiar Contrase침a</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="change-password-form">
                        <div class="form-group mb-3">
                            <label for="current-password" class="form-label">Contrase침a actual:</label>
                            <div class="input-group">
                                <input type="password" id="current-password" class="form-control" required>
                                <span class="input-group-text" id="toggleCurrentPassword"><i class="fas fa-eye"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-3">
                            <label for="new-password" class="form-label">Nueva contrase침a:</label>
                            <div class="input-group">
                                <input type="password" id="new-password" class="form-control" required>
                                <span class="input-group-text" id="toggleNewPassword"><i class="fas fa-eye"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-3">
                            <label for="confirm-new-password" class="form-label">Confirmar nueva contrase침a:</label>
                            <div class="input-group">
                                <input type="password" id="confirm-new-password" class="form-control" required>
                                <span class="input-group-text" id="toggleConfirmNewPassword"><i class="fas fa-eye"></i></span>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="save-password-btn">Cambiar contrase침a</button>
                </div>
            </div>
        </div>
    </div>

    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Bootstrap 5 JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Tempus Dominus JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/@eonasdan/tempus-dominus@6.9.4/dist/js/tempus-dominus.min.js"></script>
    <!-- Tempus Dominus Locales -->
    <script src="https://cdn.jsdelivr.net/npm/@eonasdan/tempus-dominus@6.9.4/dist/locales/es.js"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <script src="auth.js"></script>
    <script src="script.js"></script>
    <script>
      const firebaseConfig = {
        apiKey: "AIzaSyBk74mToyPXtyaCQK4mqkGTrS6yXfyWu5g",
        authDomain: "estadistica-da076.firebaseapp.com",
        databaseURL: "https://estadistica-da076-default-rtdb.firebaseio.com",
        projectId: "estadistica-da076",
        storageBucket: "estadistica-da076.appspot.com",
        messagingSenderId: "195518375872",
        appId: "1:195518375872:web:27f927e2c3e462e5424a25",
        measurementId: "G-E2YJ87LT51"
      };
      firebase.initializeApp(firebaseConfig);
      const db = firebase.database();
    </script>
</body>
</html>
